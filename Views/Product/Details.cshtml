@{
    ViewData["Title"] = "Product Details";
    ViewBag.Title = "Chi ti·∫øt s·∫£n ph·∫©m";
}


<!-- BREADCRUMB AREA START -->
    <div class="ltn__breadcrumb-area ltn__breadcrumb-area-2 ltn__breadcrumb-color-white bg-overlay-theme-black-90 bg-image" data-bg="/img/bg/9.jpg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ltn__breadcrumb-inner ltn__breadcrumb-inner-2 justify-content-between">
                        <div class="section-title-area ltn__section-title-2">
                            <h1 class="section-title white-color">Chi ti·∫øt s·∫£n ph·∫©m</h1>
                        </div>
                        <div class="ltn__breadcrumb-list">
                            <ul>
                                <li><a asp-action="Index" asp-controller="Home">Trang ch·ªß</a></li>
                                <li>Chi ti·∫øt s·∫£n ph·∫©m</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- BREADCRUMB AREA END -->

    <!-- SHOP DETAILS AREA START -->
    <div class="ltn__shop-details-area pb-85">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ltn__shop-details-inner mb-60">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="ltn__shop-details-img-gallery">
                                    <div class="ltn__shop-details-large-img">
                                        <div class="single-large-img">
                                            <img id="productImage" src="~/img/product/1.png" onerror="this.src='/Custom/no-image.webp'" alt="Image">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="modal-product-info shop-details-info pl-0">
                                    <div class="product-ratting">
                                        <ul id="productRating">
                                            <li><a href="#"><i class="fas fa-star"></i></a></li>
                                            <li><a href="#"><i class="fas fa-star"></i></a></li>
                                            <li><a href="#"><i class="fas fa-star"></i></a></li>
                                            <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                            <li><a href="#"><i class="far fa-star"></i></a></li>
                                            <li class="review-total"> <a href="#"> ( 95 Reviews )</a></li>
                                        </ul>
                                    </div>
                                    <h3 id="productName"></h3>
                                    <div class="product-price">
                                        <span id="productPrice"></span>
                                        <del id="productOldPrice"></del>
                                    </div>
                                    <div class="modal-product-meta ltn__product-details-menu-1">
                                        <ul>
                                            <li>
                                                <strong>Danh m·ª•c:</strong> 
                                                <span id="productCategory">
                                                    
                                                </span>
                                            </li>
                                            <li>
                                                <strong>Xu·∫•t x·ª©:</strong> 
                                                <span id="productOrigin">
                                                    
                                                </span>
                                            </li>
                                            <li>
                                                <strong>ƒê√°nh gi√° trung b√¨nh:</strong> 
                                                <span id="productRatingAverage">
                                                    
                                                </span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="ltn__product-details-menu-2">
                                        <ul>
                                            <li>
                                                <div class="cart-plus-minus">
                                                    <input type="text" value="1" name="qtybutton" id="quantityInput" class="cart-plus-minus-box">
                                                </div>
                                            </li>
                                            <li>
                                                <a href="#" class="theme-btn-1 btn btn-effect-1 add-to-cart-btn" title="Add to Cart" id="addToCartBtn">
                                                    <i class="fas fa-shopping-cart"></i>
                                                    <span>TH√äM V√ÄO GI·ªé H√ÄNG</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="ltn__product-details-menu-3">
                                        <ul>
                                            <li>
                                                <a href="#" class="chat-with-seller-btn" title="Chat">
                                                    <i class="far fa-comment-dots"></i>
                                                    <span>Chat v·ªõi ng∆∞·ªùi b√°n</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <hr>
                                    <div class="ltn__safe-checkout">
                                        <h5>ƒê·∫£m b·∫£o thanh to√°n an to√†n</h5>
                                        <img src="~/img/icons/payment-2.png" alt="Payment Image">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Shop Tab Start -->
                    <div class="ltn__shop-details-tab-inner ltn__shop-details-tab-inner-2">
                        <div class="ltn__shop-details-tab-menu">
                            <div class="nav">
                                <a class="active show" data-bs-toggle="tab" href="#liton_tab_details_1_1">M√¥ t·∫£</a>
                                <a data-bs-toggle="tab" href="#liton_tab_details_1_2" class="">ƒê√°nh gi√°</a>
                            </div>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane fade active show" id="liton_tab_details_1_1">
                                <div class="ltn__shop-details-tab-content-inner">
                                    <h4 class="title-2">M√¥ t·∫£ s·∫£n ph·∫©m</h4>
                                    <p id="productDescription"></p>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="liton_tab_details_1_2">
                                <div class="ltn__shop-details-tab-content-inner">
                                    <h4 class="title-2">ƒê√°nh gi√° kh√°ch h√†ng</h4>
                                    <div class="product-ratting">
                                        <ul id="productRatingTab">
                                            <!-- Rating stars will be inserted here -->
                                        </ul>
                                        <span class="review-total">(<span id="totalReviewsTab">0</span> Reviews)</span>
                                    </div>
                                    <hr>
                                    <!-- comment-area -->
                                    <div class="ltn__comment-area mb-30">
                                        <div class="ltn__comment-inner">
                                            <ul id="reviewList">
                                                <!-- Review items s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Shop Tab End -->
                </div>
            </div>
        </div>
    </div>
    <!-- SHOP DETAILS AREA END -->

    <!-- PRODUCT SLIDER AREA START -->
    <div class="ltn__product-slider-area ltn__product-gutter pb-70" style="display: none;">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-title-area ltn__section-title-2">
                        <h6 class="section-subtitle ltn__secondary-color">//  cars</h6>
                        <h1 class="section-title">Related Products<span>.</span></h1>
                    </div>
                </div>
            </div>
            <div class="row ltn__related-product-slider-one-active slick-arrow-1">
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/7.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Red Hot Tomato</a></h2>
                            <div class="product-price">
                                <span>$149.00</span>
                                <del>$162.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/8.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Vegetables Juices</a></h2>
                            <div class="product-price">
                                <span>$62.00</span>
                                <del>$85.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/9.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Orange Fresh Juice</a></h2>
                            <div class="product-price">
                                <span>$75.00</span>
                                <del>$92.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/10.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Poltry Farm Meat</a></h2>
                            <div class="product-price">
                                <span>$78.00</span>
                                <del>$85.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/5.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Fresh Butter Cake</a></h2>
                            <div class="product-price">
                                <span>$150.00</span>
                                <del>$180.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ltn__product-item -->
                <div class="col-lg-12">
                    <div class="ltn__product-item ltn__product-item-3 text-center">
                        <div class="product-img">
                            <a href="product-details.html"><img src="~/img/product/6.png" alt="#"></a>
                            <div class="product-badge">
                                <ul>
                                    <li class="sale-badge">New</li>
                                </ul>
                            </div>
                            <div class="product-hover-action">
                                <ul>
                                    <li>
                                        <a href="#" title="Quick View" data-bs-toggle="modal" data-bs-target="#quick_view_modal">
                                            <i class="far fa-eye"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Add to Cart" data-bs-toggle="modal" data-bs-target="#add_to_cart_modal">
                                            <i class="fas fa-shopping-cart"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" title="Wishlist" data-bs-toggle="modal" data-bs-target="#liton_wishlist_modal">
                                            <i class="far fa-heart"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-ratting">
                                <ul>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star"></i></a></li>
                                    <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                    <li><a href="#"><i class="far fa-star"></i></a></li>
                                </ul>
                            </div>
                            <h2 class="product-title"><a href="product-details.html">Orange Sliced Mix</a></h2>
                            <div class="product-price">
                                <span>$150.00</span>
                                <del>$180.00</del>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  -->
            </div>
        </div>
    </div>
    <!-- PRODUCT SLIDER AREA END -->

    <!-- FEATURE AREA START ( Feature - 3) -->
    <div class="ltn__feature-area before-bg-bottom-2 mb--30--- plr--5">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ltn__feature-item-box-wrap ltn__border-between-column white-bg">
                        <div class="row">
                            <div class="col-xl-3 col-md-6 col-12">
                                <div class="ltn__feature-item ltn__feature-item-8">
                                    <div class="ltn__feature-icon">
                                        <img src="~/img/icons/icon-img/11.png" alt="#">
                                    </div>
                                    <div class="ltn__feature-info">
                                        <h4>Curated Products</h4>
                                        <p>Provide Curated Products for
                                            all product over $100</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6 col-12">
                                <div class="ltn__feature-item ltn__feature-item-8">
                                    <div class="ltn__feature-icon">
                                        <img src="~/img/icons/icon-img/12.png" alt="#">
                                    </div>
                                    <div class="ltn__feature-info">
                                        <h4>Handmade</h4>
                                        <p>We ensure the product quality
                                            that is our main goal</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6 col-12">
                                <div class="ltn__feature-item ltn__feature-item-8">
                                    <div class="ltn__feature-icon">
                                        <img src="~/img/icons/icon-img/13.png" alt="#">
                                    </div>
                                    <div class="ltn__feature-info">
                                        <h4>Natural Food</h4>
                                        <p>Return product within 3 days
                                            for any product you buy</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6 col-12">
                                <div class="ltn__feature-item ltn__feature-item-8">
                                    <div class="ltn__feature-icon">
                                        <img src="~/img/icons/icon-img/14.png" alt="#">
                                    </div>
                                    <div class="ltn__feature-info">
                                        <h4>Free home delivery</h4>
                                        <p>We ensure the product quality
                                            that you can trust easily</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- FEATURE AREA END -->

    <script type="module">
        import { BaseService } from "/Custom/BaseService.js";
        import key from "/Custom/jwt.js";
        import url from "/Custom/endpoints.js";
        import Toast from "/Custom/Toast.js";

        const productUrl = url.base + "/Product";
        const productService = new BaseService(productUrl, key);
        const cartUrl = url.base + "/Cart";
        const cartService = new BaseService(cartUrl, key);
        const chatUrl = url.base + "/Chat";
        const chatService = new BaseService(chatUrl, key);

        // ·∫®n Top Rated Product Widget
        document.addEventListener("DOMContentLoaded", function() {
            const topRatedWidget = document.querySelector('.ltn__top-rated-product-widget');
            if (topRatedWidget) topRatedWidget.style.display = "none";
            const bannerWidget = document.querySelector('.ltn__banner-widget');
            if (bannerWidget) bannerWidget.style.display = "none";
            // ·∫®n sidebar lu√¥n cho ch·∫Øc c√∫ >< 
            const sidebar = document.querySelector('.ltn__shop-sidebar');
            if (sidebar) sidebar.style.display = "none";
        });

        const app = {
            productId: null,
            sellerId: null,
            init: function() {
                this.loadProductDetails();
                this.setupAddToCart();
                this.setupChatWithSeller();
            },
            loadProductDetails: function() {
                // L·∫•y product id t·ª´ URL parameter üîç
                const urlParams = new URLSearchParams(window.location.search);
                this.productId = urlParams.get('id');
                
                if (this.productId) {
                    // L·∫•y th√¥ng tin s·∫£n ph·∫©m 
                    productService.getById(this.productId).then(response => {
                        if (response && response.success && response.data) {
                            app.renderProductDetails(response.data);
                            app.sellerId = response.data.storeId; // L∆∞u sellerId
                        }
                    });
                    // L·∫•y ƒë√°nh gi√° s·∫£n ph·∫©m
                    productService.fetchApi(`/${this.productId}/reviews`, 'GET').then(response => {
                        if (response && response.success && response.data) {
                            app.renderProductReviews(response.data);
                        }
                    });
                } else {
                    alert("Kh√¥ng t√¨m th·∫•y th√¥ng tin s·∫£n ph·∫©m !");
                    window.location.href = "/Product/Index";
                }
            },
            setupAddToCart: function() {
                // Th√™m s·ª± ki·ªán click cho n√∫t Add to Cart
                document.getElementById('addToCartBtn').addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // L·∫•y s·ªë l∆∞·ª£ng t·ª´ input
                    const quantity = parseInt(document.getElementById('quantityInput').value) || 1;
                    
                    // G·ªçi API th√™m v√†o gi·ªè h√†ng
                    cartService.fetchApi("/items", "POST", {
                        "productId": parseInt(app.productId),
                        "quantity": quantity
                    }).then(response => {
                        console.log("Add to cart response:", response);
                        if (response.success) {
                            // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
                            Toast.success("S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c th√™m v√†o gi·ªè h√†ng!");
                        } else {
                            Toast.error("Kh√¥ng th·ªÉ th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng. Vui l√≤ng th·ª≠ l·∫°i sau!");
                        }
                    }).catch(error => {
                        console.error("Error adding to cart:", error);
                        Toast.error("ƒê√£ x·∫£y ra l·ªói khi th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng!");
                    });
                });
            },
            setupChatWithSeller: function() {
                document.querySelector('.chat-with-seller-btn').addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const token = localStorage.getItem('accessToken');
                    if (!token) {
                        Toast.error("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ chat v·ªõi ng∆∞·ªùi b√°n!");
                        window.location.href = "/Home/Login";
                        return;
                    }
                    
                    if (!app.sellerId) {
                        Toast.error("Kh√¥ng t√¨m th·∫•y th√¥ng tin ng∆∞·ªùi b√°n!");
                        return;
                    }
                    
                    // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i
                    const userId = localStorage.getItem('id');
                    
                    if (!userId) {
                        Toast.error("B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ chat v·ªõi ng∆∞·ªùi b√°n!");
                        window.location.href = "/Home/Login";
                        return;
                    }
                    
                    // T·∫°o ph√≤ng chat
                    const data = {
                        targetUserId: parseInt(app.sellerId),
                        currentUserId: parseInt(userId),
                        roomName: `Chat v·ªõi ng∆∞·ªùi b√°n - S·∫£n ph·∫©m: ${document.getElementById('productName').textContent}`,
                        description: `Chat v·ªÅ s·∫£n ph·∫©m: ${document.getElementById('productName').textContent}`
                    };
                    
                    chatService.fetchApi("/create", 'POST', data)
                        .then(response => {
                            if (response) {
                                // Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang chat
                                window.location.href = `/Account/Chat?room=${response.id}`;
                            } else {
                                Toast.error("Kh√¥ng th·ªÉ t·∫°o ph√≤ng chat. Vui l√≤ng th·ª≠ l·∫°i sau!");
                            }
                        })
                        .catch(error => {
                            console.error("L·ªói khi t·∫°o ph√≤ng chat:", error);
                            Toast.error("ƒê√£ x·∫£y ra l·ªói khi t·∫°o ph√≤ng chat!");
                        });
                });
            },
            renderProductDetails: function(data) {
                // Hi·ªÉn th·ªã th√¥ng tin s·∫£n ph·∫©m
                document.getElementById('productName').textContent = data.name;
                document.getElementById('productDescription').textContent = data.description;
                document.getElementById('productPrice').textContent = data.price.toLocaleString('vi-VN') + " ƒë";
                document.getElementById('productCategory').textContent = data.category ? data.category.name : '';
                document.getElementById('productOrigin').textContent = data.origin || '';
                document.getElementById('productRatingAverage').textContent = data.averageRating || 0;
                document.getElementById('productImage').src = url.baseUrl + "/img/Products/" + (data.imageUrl || "no-image.png");

                // Hi·ªÉn th·ªã rating
                app.renderRating('productRating', data.averageRating);
                app.renderRating('productRatingTab', data.averageRating);
                document.getElementById('totalReviewsTab').textContent = (data.reviews ? data.reviews.length : 0);
            },
            renderProductReviews: function(data) {
                // Hi·ªÉn th·ªã danh s√°ch ƒë√°nh gi√°
                const reviewList = document.getElementById('reviewList');
                reviewList.innerHTML = '';
                if (data.reviews && data.reviews.length > 0) {
                    data.reviews.forEach(review => {
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <div class="ltn__comment-item clearfix">
                                <div class="ltn__commenter-img">
                                    <img src="${url.baseUrl}/img/Users/default.jpg" alt="Image">
                                </div>
                                <div class="ltn__commenter-comment">
                                    <h6><a href="#">Kh√°ch h√†ng ${review.userId || ''}</a></h6>
                                    <div class="product-ratting">
                                        ${app.getStarHtml(review.rating)}
                                    </div>
                                    <p>${review.content}</p>
                                    <span class="ltn__comment-reply-btn">${new Date(review.createdAt).toLocaleDateString('vi-VN')}</span>
                                    ${review.shopResponse ? `<div class="shop-response" style="margin-top:8px; color: #2e8b57;"><b>Ph·∫£n h·ªìi shop:</b> ${review.shopResponse}</div>` : ''}
                                </div>
                            </div>
                        `;
                        reviewList.appendChild(li);
                    });
                } else {
                    reviewList.innerHTML = '<li>Ch∆∞a c√≥ ƒë√°nh gi√° n√†o cho s·∫£n ph·∫©m n√†y</li>';
                }
            },
            renderRating: function(elementId, rating) {
                const ul = document.getElementById(elementId);
                if (!ul) return;
                ul.innerHTML = app.getStarHtml(rating);
            },
            getStarHtml: function(rating) {
                let html = '';
                let full = Math.floor(rating);
                let half = rating - full >= 0.5 ? 1 : 0;
                let empty = 5 - full - half;
                for (let i = 0; i < full; i++) html += '<li><a href="#"><i class="fas fa-star"></i></a></li>';
                if (half) html += '<li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>';
                for (let i = 0; i < empty; i++) html += '<li><a href="#"><i class="far fa-star"></i></a></li>';
                return html;
            }
        };
        app.init();
    </script>